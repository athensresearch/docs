<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Self-Hosting Backend | Athens Research</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://athensresearch.github.io/docs/developer_guide/self-hosted"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Self-Hosting Backend | Athens Research"><meta data-react-helmet="true" name="description" content="No Data Loss"><meta data-react-helmet="true" property="og:description" content="No Data Loss"><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://athensresearch.github.io/docs/developer_guide/self-hosted"><link data-react-helmet="true" rel="alternate" href="https://athensresearch.github.io/docs/developer_guide/self-hosted" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://athensresearch.github.io/docs/developer_guide/self-hosted" hreflang="x-default"><link rel="stylesheet" href="/docs/assets/css/styles.f4e51aac.css">
<link rel="preload" href="/docs/assets/js/runtime~main.2470dbb7.js" as="script">
<link rel="preload" href="/docs/assets/js/main.4602f8a8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/athens-icon.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/docs/img/athens-icon.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Athens</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">About Athens</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Developer Guide</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/running">Running Athens Locally</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developer_guide/self-hosted">Self-Hosting Backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/repl">REPL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/ci">Continuous Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/git">Git and GitHub Conventions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/storybook">Storybook JS Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/resources">Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer_guide/architecture">Architecture</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Self-Hosting Backend</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="no-data-loss">No Data Loss<a aria-hidden="true" class="hash-link" href="#no-data-loss" title="Direct link to heading">â€‹</a></h2><p>Our number one design principle is to never have data loss.</p><p>All accounts of data loss will be documented publicly on our <a href="https://github.com/athensresearch/athens/discussions/categories/post-mortems" target="_blank" rel="noopener noreferrer">GitHub Discussions</a>.</p><p>Our last (and only) account of data loss was in February 2021 on our local-only version of Athens, before we made a public release, posted by a developer contributor.</p><p>When the self-hosted backend was in <code>alpha</code>, we had known issues of data loss, crashing, and freezing because the distributed events system being incomplete. We discovered and solved these issues internally as a team. We did not invite others to use this build during this period.</p><p>Now we are in <code>beta</code>, meaning we are ready to open up Athens for beta testers. We don&#x27;t have known issues with data loss, crashing, and freezing anymore, and the first implementation of the distributed events system is complete. That said, we need to open this up to beta at this point because we need more real-world testing in a variety of contexts beyond our own team of six to go from <code>beta</code> to <code>stable</code>.</p><p>We invite feedback on anything and everything, don&#x27;t be shy! We&#x27;ve created two new Discord channels, 2.0.0-beta and data loss at <strong>2.0.0-beta-feedback</strong> and <strong>#data-loss</strong>, respectively. <a href="https://discord.gg/avzDmq3nah" target="_blank" rel="noopener noreferrer">Join us on Discord!</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="client">Client<a aria-hidden="true" class="hash-link" href="#client" title="Direct link to heading">â€‹</a></h2><p>To connect to an Athens server, you must know its remote address (an IP address, URL, or localhost) and its password. Skip to <a href="#server">server</a> to setup a server first if you haven&#x27;t yet.</p><p>You can connect to the backend through the DB Picker. Open the DB Picker with the button in the top left:</p><p><img src="https://user-images.githubusercontent.com/8952138/142514926-f61c4070-f3b5-4ded-b8a4-2219c410a64d.png" alt="db-picker-button"></p><p>Go the <strong>Join</strong> tab and add the database name (give whatever name you want, it is only stored on the client), the remote address (which you can get from the server administrator), and the password (leave empty if no password). Then press the <strong>Join</strong> button.</p><p><img src="https://user-images.githubusercontent.com/8952138/142514744-c87d95b9-ee6d-4f39-839f-75d2f8f1c5f9.png" alt="join-tab"></p><p>If the address and password match, congrats! You should be in a collaborative, self-hosted Athens! Read more</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="server">Server<a aria-hidden="true" class="hash-link" href="#server" title="Direct link to heading">â€‹</a></h2><p>You can run Athens in your local environment, <a href="#docker">Docker</a>, or <a href="#digitalocean">DigitalOcean</a>. Setup docs do not yet exist for AWS or GCP, but feel free to contribute and add these!</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="custom-config">Custom Config<a aria-hidden="true" class="hash-link" href="#custom-config" title="Direct link to heading">â€‹</a></h3><p>The default configuration can be found in <code>config.edn</code>.
You can customize it through the <code>config_edn</code> environment variable.</p><p>Here&#x27;s an example on how to configure the server password using <code>config_edn</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">config_edn: &quot;{:password &quot;YourServerPassword&quot;}&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>config_edn</code> will be merged to other configs via deep merging.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="running-athens-self-hosted-server">Running Athens Self-Hosted Server<a aria-hidden="true" class="hash-link" href="#running-athens-self-hosted-server" title="Direct link to heading">â€‹</a></h3><p>Run the following commands in two different terminals:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up fluree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> server</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The first command starts the Fluree database using docker to persist data.
If you set <code>:in-memory? false</code> in <code>dev/clj/config.edn</code> no data is persisted and this command is not needed.</p><p>The second command will start HTTP server on port 3010, unless you&#x27;ve modified <code>dev/clj/config.edn</code>.</p><p>Also nREPL server is started on port 8877, unless you&#x27;ve modified <code>dev/clj/config.edn</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="developing-athens-self-hosted-server">Developing Athens Self-Hosted Server<a aria-hidden="true" class="hash-link" href="#developing-athens-self-hosted-server" title="Direct link to heading">â€‹</a></h3><p>Start REPL:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> server:repl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Start the system:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI clojure"><pre tabindex="0" class="prism-code language-clojure codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">(dev)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(start)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Same way you can start the system after <code>cider-jack-in</code>.</p><p>After starting HTTP &amp; nREPL servers are running on default ports or changes in <code>config.edn</code>.</p><p><strong>Resetting the system</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI clojure"><pre tabindex="0" class="prism-code language-clojure codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">(reset)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Clean the Fluree DB</strong></p><p>Stop the Self-Hosted server. <!-- -->[ctrl+c]<!-- --> if using <code>yarn server</code> or <!-- -->[ctrl+d]<!-- --> if repl.
By default Fluree DB is stored in <code>./athens-data/fluree</code>, remove this folder,
start the server and Bob&#x27;s your unkle.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="docker">Docker<a aria-hidden="true" class="hash-link" href="#docker" title="Direct link to heading">â€‹</a></h2><p>You can create an Athens server without installing anything else via docker compose.</p><p>At any point, if any of the services fails to launch or something seems broken, you have two options to debug.</p><ol><li>You can run <code>docker-compose ps</code>  to see all running services. You should see that services <code>fluree</code>, <code>athens</code>, and <code>nginx</code> are &quot;up&quot; and/or &quot;healthy&quot;. <img src="https://user-images.githubusercontent.com/8952138/142656719-21c54b94-8f50-4091-9044-a72bac1988a2.png" alt="docker-ps-output"></li><li>Additionally, you can use <code>docker-compose logs SERVICE_NAME</code> to inspect what the problem is further.</li></ol><p>Pick a <a href="https://github.com/athensresearch/athens/releases" target="_blank" rel="noopener noreferrer">release</a> you&#x27;d like to use and download the <code>docker-compose.yml</code>. For example, for <code>v2.0.0-beta.6</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">curl -L -o docker-compose.yml https://github.com/athensresearch/athens/releases/download/v2.0.0-beta.6/docker-compose.yml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>On Linux, <code>fluree</code> fails to launch if it does not have enough permissions for the <code>./athens-data</code> folder. The current workaround for this is to manually create the data folder and give all users of the machine read and write access. This is not a long-term workaround, and we will have more constrained permissions before Athens RTC is available for general release.</p><p>If you are on Mac, you can skip this workaround.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ./athens-data/fluree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod -R 777 ./athens-data/fluree</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Then, start Docker Compose!</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up --detach</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you want to configure a password, you can override the app configuration via an environment variable:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG_EDN=&quot;{:password \&quot;YourServerPassword\&quot;}&quot; docker-compose up</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>or via an <code>.env</code> file located in the same directory as the downloaded <code>docker-compose.yml</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sh"><pre tabindex="0" class="prism-code language-sh codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG_EDN=&quot;{:password \&quot;YourServerPassword\&quot;}&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Currently, the only server config we have is for the password. If you update the password, then clients that previously logged in will not have access unless. They must update the password on their end to get back in.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="updating-docker">Updating Docker<a aria-hidden="true" class="hash-link" href="#updating-docker" title="Direct link to heading">â€‹</a></h3><p>To update your deployment, curl the new <code>docker-compose.yml</code> file and restart docker-compose entirely:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># curl a new version of Athens described by docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -L -o docker-compose.yml https://github.com/athensresearch/athens/releases/download/v2.0.0-beta.6/docker-compose.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># restart docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose down</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up --detach</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="digitalocean">DigitalOcean<a aria-hidden="true" class="hash-link" href="#digitalocean" title="Direct link to heading">â€‹</a></h2><p>Athens the team has tested the backend beta server on DigitalOcean the most, and not as much yet on other cloud providers like AWS or GCP.</p><p>A minimum of 4gb of memory is needed.</p><p><img src="https://user-images.githubusercontent.com/8952138/141150237-dce5f183-f25c-4a9b-9526-dcc310c09a44.png" alt="image"></p><p>Use marketplace docker image: <code>docker 19.03.12 on Ubuntu 20.04</code> which has docker and docker-compose pre-installed.</p><p><img src="https://user-images.githubusercontent.com/8952138/141150155-7be8bce5-1804-431c-9cd0-4cf11e9c8d87.jpg" alt="digital-ocean-docker-image"></p><p>If you resize your droplet image and have trouble opening the console, just wait a few minutes and refresh the Digital Ocean dashboard.</p><p>Once your droplet has been created, open the console to ssh to the server, follow the instructions in <a href="#docker">Docker</a> to start the server, and copy and paste the IP address to your Athens client to connect to the server (and add a password if you configured one).</p><p><img src="https://user-images.githubusercontent.com/8952138/141150925-9f8df004-faa0-4fbe-9875-c276d60c5118.jpg" alt="digital-ocean-console-and-ip-address"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="backup-your-server">Backup your server<a aria-hidden="true" class="hash-link" href="#backup-your-server" title="Direct link to heading">â€‹</a></h2><p>The backup method is currently an MVP. Please feel free to reach out on Discord or through <a href="mailto:info@athensresearch.org" target="_blank" rel="noopener noreferrer">info@athensresearch.org</a> for help, feedback, and questions.</p><p>We call &quot;Backups&quot; &quot;Save-Load&quot; because our backups have 2 parts: saving/backing up and loading/restoring.</p><p>To backup your server, you need to have:</p><ul><li>An <a href="https://github.com/athensresearch/athens" target="_blank" rel="noopener noreferrer">Athens repo</a> cloned locally. We refer to this as <strong>LC</strong>, short for <code>local computer</code>, below.</li><li>A cloud server, for instance, hosted on <a href="#digitalocean">DigitalOcean</a>, and <code>ssh</code> access to it. We refer to this as <strong>RS</strong> short for <code>remote server</code>, below.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="save-backup-your-server">Save (Backup) Your Server<a aria-hidden="true" class="hash-link" href="#save-backup-your-server" title="Direct link to heading">â€‹</a></h3><p>To backup your Athens server you need to the following steps:</p><p><strong>LC</strong></p><p>Clone Athens on your local computer.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">git clone git@github.com:athensresearch/athens.git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Go to the Athens folder.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">cd athens</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Compile the <code>save-load</code> command line utility.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">yarn cli:compile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn cli:uberjar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>RS</strong></p><p>Get the <strong>remote server</strong> address e.g <code>123.456.78.9</code>
Send the uberjar and script to remote server. Replace <code>&quot;$REMOTE_IP&quot;</code> with the actual remote server address.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">scp target/athens-cli.jar root@&quot;$REMOTE_IP&quot;:~/athens-cli.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scp script/save-cronjob.sh root@&quot;$REMOTE_IP&quot;~/:save-cronjob.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>LC</strong></p><p>ssh into the remote server</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@&quot;$REMOTE_IP&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Check to see if <code>athens-cli.jar</code> and <code>save-cronjob.sh</code> files are present on the remote server</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain"># expected output</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Set up an hourly cronjob for the Save (Backup). This involves using crontab, a terminal user interface, to save your Fluree ledger, the source of truth (essentially the database) in self-hosted Athens.</p><p>Backups are stored to the <code>/var/lib/athens/backups/</code> folder.</p><p>Open the crontab terminal user interface, which also contains documentation on its time parameters.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">crontab -e</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Add the following line to the file: <code>0 */1 * * * ~/save-cronjob.sh</code></p><p>To change the frequency of the backups, change the cronjob parameters accordingly, following the cronjob documentation shown after running <code>crontab -e</code>.</p><p>After at least an hour, check that backups are happening:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /var/lib/athens/backups/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You should see a list of files such as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785081 Jan  4 12:01 2022-01-04-12-00.edn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785858 Jan  4 13:01 2022-01-04-13-00.edn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="load-restore-your-server">Load (Restore) Your Server<a aria-hidden="true" class="hash-link" href="#load-restore-your-server" title="Direct link to heading">â€‹</a></h3><p><strong>LC</strong></p><p>ssh into the remote server.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@&quot;$REMOTE_IP&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>RS</strong></p><p>Stop the Athens server.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose stop athens</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find the file that you want to restore from.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /var/lib/athens/backups</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You should see a list of files such as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785081 Jan  4 12:01 2022-01-04-12-00.edn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785858 Jan  4 13:01 2022-01-04-13-00.edn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10792868 Jan  4 14:01 2022-01-04-14-00.edn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Load the file to Athens server, replacing <code>&quot;$FILENAME</code> with the correct filename.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">java -jar ~/athens-cli.jar load -f &quot;$FILENAME&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Follow the instructions outputted by the above command.</p><p>Restart the Athens server
<code>docker-compose start athens</code>
If you are not able to load (Restore) the file please go through the steps again and if the problem still exists then let us know in our Discord server.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="copy-your-backup-to-your-local-machine">Copy Your Backup to Your Local Machine<a aria-hidden="true" class="hash-link" href="#copy-your-backup-to-your-local-machine" title="Direct link to heading">â€‹</a></h3><p>Here we assume that you have gone through the Save (Backup) process</p><p><strong>RS</strong></p><p>ssh into the remote server</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@&quot;$REMOTE_IP&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Find the name of file you want to get.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /var/lib/athens/backups</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You should see a list of files such as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785081 Jan  4 12:01 2022-01-04-12-00.edn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10785858 Jan  4 13:01 2022-01-04-13-00.edn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 10792868 Jan  4 14:01 2022-01-04-14-00.edn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Get the server log to local machine.</p><ul><li>Replace <code>&quot;$REMOTE_IP&quot;</code> with the actual IP</li><li>Replace <code>&quot;$FILENAME&quot;</code> with the actual filename.</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">scp root@&quot;$REMOTE_IP&quot;:/var/lib/athens/backups/&quot;$FILENAME&quot; ./</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/athensresearch/docs/edit/main/docs/developer_guide/self-hosted.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/developer_guide/running"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Running Athens Locally</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/developer_guide/repl"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">REPL<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#no-data-loss" class="table-of-contents__link toc-highlight">No Data Loss</a></li><li><a href="#client" class="table-of-contents__link toc-highlight">Client</a></li><li><a href="#server" class="table-of-contents__link toc-highlight">Server</a><ul><li><a href="#custom-config" class="table-of-contents__link toc-highlight">Custom Config</a></li><li><a href="#running-athens-self-hosted-server" class="table-of-contents__link toc-highlight">Running Athens Self-Hosted Server</a></li><li><a href="#developing-athens-self-hosted-server" class="table-of-contents__link toc-highlight">Developing Athens Self-Hosted Server</a></li></ul></li><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a><ul><li><a href="#updating-docker" class="table-of-contents__link toc-highlight">Updating Docker</a></li></ul></li><li><a href="#digitalocean" class="table-of-contents__link toc-highlight">DigitalOcean</a></li><li><a href="#backup-your-server" class="table-of-contents__link toc-highlight">Backup your server</a><ul><li><a href="#save-backup-your-server" class="table-of-contents__link toc-highlight">Save (Backup) Your Server</a></li><li><a href="#load-restore-your-server" class="table-of-contents__link toc-highlight">Load (Restore) Your Server</a></li><li><a href="#copy-your-backup-to-your-local-machine" class="table-of-contents__link toc-highlight">Copy Your Backup to Your Local Machine</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/AKQrE9HUt4" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/AthensResearch/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/athensresearch/athens/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://athensresearch.ghost.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Athens Research, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.2470dbb7.js"></script>
<script src="/docs/assets/js/main.4602f8a8.js"></script>
</body>
</html>